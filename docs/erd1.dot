digraph LoadStuffingCalculator_MultiTenant {
    graph [
        rankdir="LR"
        nodesep=0.6  // Jarak vertikal antar tabel
        ranksep=1.2  // Jarak horizontal diperlebar biar kabel lega
        splines=ortho // Garis siku-siku
        pad="0.5"
        fontname="Arial"
        bgcolor="#FFFFFF"
    ];
    
    node [
        shape=plaintext
        fontname="Arial"
        fontsize=10
    ];
    
    edge [
        fontname="Arial"
        fontsize=9
        color="#444444"
        arrowsize=0.7
    ];

    // ==================================================
    // CLUSTER 1: AUTHENTICATION & USERS (BLUE)
    // ==================================================
    subgraph cluster_auth {
        label="AUTH & USERS"
        style=filled
        color="#E1F5FE"

        users [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#0288D1"><B><FONT COLOR="WHITE">users</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>user_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_role"><B>role_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">username</TD><TD ALIGN="LEFT">VARCHAR(50)</TD><TD ALIGN="LEFT">UQ</TD></TR>
                <TR><TD ALIGN="LEFT">email</TD><TD ALIGN="LEFT">VARCHAR(255)</TD><TD ALIGN="LEFT">UQ</TD></TR>
                <TR><TD ALIGN="LEFT">password_hash</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        user_profiles [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#0288D1"><B><FONT COLOR="WHITE">user_profiles</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>profile_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_user"><B>user_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK/UQ</B></TD></TR>
                <TR><TD ALIGN="LEFT">full_name</TD><TD ALIGN="LEFT">VARCHAR(100)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">gender</TD><TD ALIGN="LEFT">VARCHAR(20)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">date_of_birth</TD><TD ALIGN="LEFT">DATE</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">phone_number</TD><TD ALIGN="LEFT">VARCHAR(20)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">address</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">avatar_url</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        refresh_tokens [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#0288D1"><B><FONT COLOR="WHITE">refresh_tokens</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>token</B></TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_user"><B>user_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_workspace"><B>workspace_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">expires_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">revoked_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        roles [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#0277BD"><B><FONT COLOR="WHITE">roles</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>role_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT">name</TD><TD ALIGN="LEFT">VARCHAR(50)</TD><TD ALIGN="LEFT">UQ</TD></TR>
                <TR><TD ALIGN="LEFT">description</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        permissions [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#0277BD"><B><FONT COLOR="WHITE">permissions</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>permission_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT">name</TD><TD ALIGN="LEFT">VARCHAR(100)</TD><TD ALIGN="LEFT">UQ</TD></TR>
                <TR><TD ALIGN="LEFT">description</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        role_permissions [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#0277BD"><B><FONT COLOR="WHITE">role_permissions</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_role"><B>role_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK/FK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_perm"><B>permission_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK/FK</B></TD></TR>
            </TABLE>
        >];
    }

    // ==================================================
    // CLUSTER 2: WORKSPACES (TEAL - MULTI-TENANT)
    // ==================================================
    subgraph cluster_workspace {
        label="WORKSPACES (MULTI-TENANT)"
        style=filled
        color="#E0F2F1"

        workspaces [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#00897B"><B><FONT COLOR="WHITE">workspaces</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>workspace_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT">type</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT">CHECK</TD></TR>
                <TR><TD ALIGN="LEFT">name</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_owner"><B>owner_user_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        members [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#00897B"><B><FONT COLOR="WHITE">members</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>member_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_workspace"><B>workspace_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_user"><B>user_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_role"><B>role_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        invites [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#00897B"><B><FONT COLOR="WHITE">invites</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>invite_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_workspace"><B>workspace_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">email</TD><TD ALIGN="LEFT">VARCHAR(255)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_role"><B>role_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">token_hash</TD><TD ALIGN="LEFT">TEXT</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_invited_by"><B>invited_by_user_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">expires_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">accepted_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">revoked_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        platform_members [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#00695C"><B><FONT COLOR="WHITE">platform_members</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk_fk_user"><B>user_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK/FK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_role"><B>role_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];
    }

    // ==================================================
    // CLUSTER 3: MASTER DATA (GREEN)
    // ==================================================
    subgraph cluster_master {
        label="MASTER DATA (LIBRARY)"
        style=filled
        color="#E8F5E9" 

        containers [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#2E7D32"><B><FONT COLOR="WHITE">containers</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>container_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_workspace"><B>workspace_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">label</TD><TD ALIGN="LEFT">VARCHAR(100)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">length_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">width_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">height_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">max_weight_kg</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        products [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#2E7D32"><B><FONT COLOR="WHITE">products</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>product_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_workspace"><B>workspace_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">label</TD><TD ALIGN="LEFT">VARCHAR(150)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">length_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">width_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">height_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">weight_kg</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">allow_rotation</TD><TD ALIGN="LEFT">BOOLEAN</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">max_stack</TD><TD ALIGN="LEFT">INTEGER</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">color_hex</TD><TD ALIGN="LEFT">VARCHAR(7)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">updated_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];
    }

    // ==================================================
    // CLUSTER 4: CALCULATION (ORANGE)
    // ==================================================
    subgraph cluster_calc {
        label="CALCULATION ENGINE"
        style=filled
        color="#FFF3E0" 

        load_plans [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#EF6C00"><B><FONT COLOR="WHITE">load_plans</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>plan_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_workspace"><B>workspace_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">plan_code</TD><TD ALIGN="LEFT">VARCHAR(50)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">status</TD><TD ALIGN="LEFT">VARCHAR(20)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">cont_label</TD><TD ALIGN="LEFT">VARCHAR(100)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">length_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">width_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">height_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">max_weight_kg</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        load_items [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#EF6C00"><B><FONT COLOR="WHITE">load_items</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>item_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_plan"><B>plan_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">item_label</TD><TD ALIGN="LEFT">VARCHAR(150)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">length_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">width_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">height_mm</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">weight_kg</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">quantity</TD><TD ALIGN="LEFT">INTEGER</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">allow_rotation</TD><TD ALIGN="LEFT">BOOLEAN</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">color_hex</TD><TD ALIGN="LEFT">VARCHAR(7)</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        plan_results [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#EF6C00"><B><FONT COLOR="WHITE">plan_results</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>result_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_plan"><B>plan_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">total_loaded_weight_kg</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">volume_utilization_pct</TD><TD ALIGN="LEFT">NUMERIC(5,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">is_feasible</TD><TD ALIGN="LEFT">BOOLEAN</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">created_at</TD><TD ALIGN="LEFT">TIMESTAMPTZ</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];

        plan_placements [label=<
            <TABLE BORDER="0" CELLBORDER="1" CELLSPACING="0" BGCOLOR="#FFFFFF">
                <TR><TD COLSPAN="3" BGCOLOR="#EF6C00"><B><FONT COLOR="WHITE">plan_placements</FONT></B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="pk"><B>placement_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>PK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_result"><B>result_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="fk_item"><B>item_id</B></TD><TD ALIGN="LEFT">UUID</TD><TD ALIGN="LEFT"><B>FK</B></TD></TR>
                <TR><TD ALIGN="LEFT">pos_x</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">pos_y</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">pos_z</TD><TD ALIGN="LEFT">NUMERIC(10,2)</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">rotation_code</TD><TD ALIGN="LEFT">INTEGER</TD><TD ALIGN="LEFT"></TD></TR>
                <TR><TD ALIGN="LEFT">step_number</TD><TD ALIGN="LEFT">INTEGER</TD><TD ALIGN="LEFT"></TD></TR>
            </TABLE>
        >];
    }

    // ==================================================
    // RELATIONSHIPS (HARD FK)
    // ==================================================

    // Auth relationships
    roles:pk:e -> users:fk_role:w;
    roles:pk:e -> role_permissions:fk_role:w;
    permissions:pk:e -> role_permissions:fk_perm:w;
    users:pk:e -> user_profiles:fk_user:w;
    users:pk:e -> refresh_tokens:fk_user:w;

    // Workspace relationships
    users:pk:e -> workspaces:fk_owner:w;
    workspaces:pk:e -> members:fk_workspace:w;
    users:pk:e -> members:fk_user:w;
    roles:pk:e -> members:fk_role:w;
    workspaces:pk:e -> invites:fk_workspace:w;
    users:pk:e -> invites:fk_invited_by:w;
    roles:pk:e -> invites:fk_role:w;
    users:pk:e -> platform_members:pk_fk_user:w;
    roles:pk:e -> platform_members:fk_role:w;

    // Workspace scoping (multi-tenant isolation)
    workspaces:pk:e -> refresh_tokens:fk_workspace:w [style=dotted label="context"];
    workspaces:pk:e -> containers:fk_workspace:w;
    workspaces:pk:e -> products:fk_workspace:w;
    workspaces:pk:e -> load_plans:fk_workspace:w;

    // Calculation relationships
    load_plans:pk:e -> load_items:fk_plan:w;
    load_plans:pk:e -> plan_results:fk_plan:w;
    plan_results:pk:e -> plan_placements:fk_result:w;
    load_items:pk:e -> plan_placements:fk_item:w;

    // ==================================================
    // LOGICAL / SNAPSHOT RELATIONS (DOTTED GREEN)
    // ==================================================
    products:pk:e -> load_items:pk:w [style=dashed color="#2E7D32" label="Snapshot"];
    containers:pk:e -> load_plans:pk:w [style=dashed color="#2E7D32" label="Snapshot"];
}
